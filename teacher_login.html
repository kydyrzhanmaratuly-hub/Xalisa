<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="teacher_login.css">
    <title>–í—Ö–æ–¥ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π</title>
    
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üë®‚Äçüè´ –í—Ö–æ–¥ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π</h1>
            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –æ—Ü–µ–Ω–∫–∞–º–∏ —Å–≤–æ–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p>
        </div>

        <div class="form-container">
            <form id="teacherLoginForm">
                <div class="form-group">
                    <label for="login">–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="login" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω" required>
                </div>

                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å" required>
                </div>

                <button type="submit" class="submit-btn">–í–æ–π—Ç–∏</button>

                <div id="message" class="message"></div>

                <div class="divider">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>

                <div class="links">
                    <a href="teacher_registration.html" id="regLink">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π</a>
                    <a href="fafa.html" id="backToStudent">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—Ö–æ–¥—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è teacher_login.html ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ?lang= –∏–ª–∏ localStorage.currentLanguage
        const teacherTranslations = {
            RU: {
                title: 'üë®‚Äçüè´ –í—Ö–æ–¥ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π',
                subtitle: '–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –æ—Ü–µ–Ω–∫–∞–º–∏ —Å–≤–æ–∏—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤',
                labelLogin: '–õ–æ–≥–∏–Ω',
                loginPlaceholder: '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω',
                labelPassword: '–ü–∞—Ä–æ–ª—å',
                passwordPlaceholder: '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–∞—Ä–æ–ª—å',
                submit: '–í–æ–π—Ç–∏',
                regLink: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π',
                backLink: '‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—Ö–æ–¥—É —Å—Ç—É–¥–µ–Ω—Ç–æ–≤'
            },
            KZ: {
                title: 'üë®‚Äçüè´ “∞—Å—Ç–∞–∑–¥–∞—Ä “Ø—à—ñ–Ω –∫—ñ—Ä—É',
                subtitle: '–û“õ—É—à—ã–ª–∞—Ä–¥—ã“£ –±–∞“ì–∞–ª–∞—Ä—ã–Ω –±–∞—Å“õ–∞—Ä—É',
                labelLogin: '–õ–æ–≥–∏–Ω',
                loginPlaceholder: '–õ–æ–≥–∏–Ω–¥—ñ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑',
                labelPassword: '“ö“±–ø–∏—è —Å”©–∑',
                passwordPlaceholder: '“ö“±–ø–∏—è —Å”©–∑–¥—ñ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑',
                submit: '–ö—ñ—Ä—É',
                regLink: '“∞—Å—Ç–∞–∑–¥–∞—Ä “Ø—à—ñ–Ω —Ç—ñ—Ä–∫–µ–ª—É',
                backLink: '‚Üê –°—Ç—É–¥–µ–Ω—Ç—Ç–µ—Ä–≥–µ –æ—Ä–∞–ª—É'
            },
            EN: {
                title: 'üë®‚Äçüè´ Teacher Login',
                subtitle: 'Manage your students grades',
                labelLogin: 'Login',
                loginPlaceholder: 'Enter your login',
                labelPassword: 'Password',
                passwordPlaceholder: 'Enter your password',
                submit: 'Login',
                regLink: 'Teacher registration',
                backLink: '‚Üê Back to student login'
            }
        };

        function applyTeacherLang(lang) {
            const L = teacherTranslations[lang] || teacherTranslations['RU'];
            // Header and subtitle
            const headerH1 = document.querySelector('.header h1');
            const headerP = document.querySelector('.header p');
            if (headerH1) headerH1.textContent = L.title;
            if (headerP) headerP.textContent = L.subtitle;

            // Labels and placeholders
            const lblLogin = document.querySelector('label[for="login"]');
            const inputLogin = document.getElementById('login');
            const lblPass = document.querySelector('label[for="password"]');
            const inputPass = document.getElementById('password');
            const submitBtn = document.querySelector('.submit-btn');
            const regLink = document.getElementById('regLink');
            const backLink = document.getElementById('backToStudent');

            if (lblLogin) lblLogin.textContent = L.labelLogin;
            if (inputLogin) inputLogin.placeholder = L.loginPlaceholder;
            if (lblPass) lblPass.textContent = L.labelPassword;
            if (inputPass) inputPass.placeholder = L.passwordPlaceholder;
            if (submitBtn) submitBtn.textContent = L.submit;
            if (regLink) regLink.textContent = L.regLink;
            if (backLink) backLink.textContent = L.backLink;

            // Update links to keep language parameter
            const param = `?lang=${lang}`;
            if (regLink) regLink.href = 'teacher_registration.html' + param;
            if (backLink) backLink.href = 'fafa.html' + param;

            // Persist choice
            try { localStorage.setItem('currentLanguage', lang); } catch (e) {}
        }

        // On load: detect lang from URL or localStorage
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            const stored = localStorage.getItem('currentLanguage');
            const lang = urlLang || stored || 'RU';
            applyTeacherLang(lang);
        })();

        document.getElementById('teacherLoginForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const login = document.getElementById('login').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!login || !password) {
                showMessage('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            try {
                const response = await fetch('http://localhost:3000/login-teacher', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ login, password })
                });

                const result = await response.json();

                if (response.ok) {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —É—á–∏—Ç–µ–ª—è
                    localStorage.setItem('teacherData', JSON.stringify(result.teacher));
                    
                    showMessage('–í—Ö–æ–¥ —É—Å–ø–µ—à–µ–Ω! –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ...', 'success');
                    setTimeout(() => {
                        window.location.href = 'teacher_dashboard.html';
                    }, 1000);
                } else {
                    showMessage(result.message || '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
                }
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É', 'error');
                console.error('Error:', error);
            }
        });

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';
        }
    </script>
</body>
</html>